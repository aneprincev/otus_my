homework_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"plhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</home_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по прhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первуhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8light highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8light highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8ю транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivanhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-chome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8light highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivanhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dirhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> |home_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8light highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8 sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-shome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8nippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-home_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">воhome_work_2/README.md","renderImageOrRaw":false,"richText":"<article class=\"markdown-body entry-content container-lg\" itemprop=\"text\"><p dir=\"auto\">выключаем auto commit:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# \\set AUTOCOMMIT OFF\npostgres=# \\echo :AUTOCOMMIT\nOFF\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\set AUTOCOMMIT OFF</span>\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> \\echo :AUTOCOMMIT</span>\nOFF</pre></div>\n<p dir=\"auto\">создаем и наполняем таблицу:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"create table persons(id serial, first_name text, second_name text);   \ninsert into persons(first_name, second_name) values('ivan', 'ivanov');  \ninsert into persons(first_name, second_name) values('petr', 'petrov');  \ncommit;\"><pre><span class=\"pl-k\">create</span> <span class=\"pl-k\">table</span> <span class=\"pl-en\">persons</span>(id <span class=\"pl-k\">serial</span>, first_name <span class=\"pl-k\">text</span>, second_name <span class=\"pl-k\">text</span>);   \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivan<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>ivanov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>petr<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>petrov<span class=\"pl-pds\">'</span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8 второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8ичине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8span></span>);  \n<span class=\"pl-k\">commit</span>;</pre></div>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\">проверяем текущий уровень изоляции:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# show transaction isolation level;\n transaction_isolation \n-----------------------\n read committed\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n read committed\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">начинаем новую транзакцию в обоих сессиях с дефолтным (не меняя) уровнем изоляции<br>\nв первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"insert into persons(first_name, second_name) values('sergey', 'sergeev');\"><pre><span class=\"pl-k\">insert into</span> persons(first_name, second_name) <span class=\"pl-k\">values</span>(<span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergey<span class=\"pl-pds\">'</span></span>, <span class=\"pl-s\"><span class=\"pl-pds\">'</span>sergeev<span class=\"pl-pds\">'</span></span>);</pre></div>\n<p dir=\"auto\">во второй сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n(2 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n(<span class=\"pl-c1\">2</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись не отображается, т.к. установлен дефолтный уровень изоляции read committed и отключен автокомит<br>\n(вставка первой транзакцией не зафиксирована)</b><br>\nфиксируем первую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">еще раз проверяем во второй транзакции</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"select * from persons;\"><pre><span class=\"pl-k\">select</span> <span class=\"pl-k\">*</span> <span class=\"pl-k\">from</span> persons;</pre></div>\n<p dir=\"auto\">результат:</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>новая запись отображается по причине того, что в первой транзакции был commit - данные зафиксированы</b><br>\nфиксируем вторую транзакцию</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">устанавливаем в сессиях уровень изоляции транзакций repeatable read</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=# set transaction isolation level repeatable read;\nSET\npostgres=*# show transaction isolation level;\n transaction_isolation \n-----------------------\n repeatable read\n(1 row)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> set transaction isolation level repeatable read;</span>\nSET\npostgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> show transaction isolation level;</span>\n transaction_isolation \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>---------------------</span>\n repeatable read\n(<span class=\"pl-c1\">1</span> row)</pre></div>\n<p dir=\"auto\">в первой сессии добавляем новую запись</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# insert into persons(first_name, second_name) values('sveta', 'svetova');\nINSERT 0 1\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> insert into persons(first_name, second_name) values('sveta', 'svetova');</span>\nINSERT <span class=\"pl-c1\">0</span> <span class=\"pl-c1\">1</span></pre></div>\n<p dir=\"auto\">во второй сессии выполняем</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, т.к. в первой сессии не было фиксации</b><br>\nфиксируем вставку в первой сессии</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"commit;\"><pre><span class=\"pl-k\">commit</span>;</pre></div>\n<p dir=\"auto\">во второй сессии повторно выполняем запрос</p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n(3 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n(<span class=\"pl-c1\">3</span> rows)</pre></div>\n<p dir=\"auto\"><b>вставленные данные не отображаются, даже при фиксации транзакции в первой сессии.<br>\nвторая транзакция видит данные (снимок данных) на момент своего начала<br>\nи не ввидит остальные завершенные изменения, сделанные в других сессиях в этот момент (фантомное чтение).<br>\nнеповторяющее чтение так же не работает - сколько бы не читали данные - реезульт будет тот же.\n</b></p>\n<p dir=\"auto\"><b>фиксируем транзакцию во второй сессии и видим изменения.</b></p>\n<div class=\"highlight highlight-source-sql notranslate position-relative overflow-auto\" dir=\"auto\" data-snippet-clipboard-copy-content=\"postgres=*# commit;\nCOMMIT\npostgres=# select * from persons;\n id | first_name | second_name \n----+------------+-------------\n  1 | ivan       | ivanov\n  2 | petr       | petrov\n  4 | sergey     | sergeev\n  5 | sveta      | svetova\n(4 rows)\"><pre>postgres<span class=\"pl-k\">=</span><span class=\"pl-k\">*</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> commit;</span>\nCOMMIT\npostgres<span class=\"pl-k\">=</span><span class=\"pl-c\"><span class=\"pl-c\">#</span> select * from persons;</span>\n id | first_name | second_name \n<span class=\"pl-c\"><span class=\"pl-c\">--</span>--+------------+-------------</span>\n  <span class=\"pl-c1\">1</span> | ivan       | ivanov\n  <span class=\"pl-c1\">2</span> | petr       | petrov\n  <span class=\"pl-c1\">4</span> | sergey     | sergeev\n  <span class=\"pl-c1\">5</span> | sveta      | svetova\n(<span class=\"pl-c1\">4</span> rows)</pre></div>\n</article>","renderedFileInfo":null,"shortPath":null,"symbolsEnabled":true,"tabSize":8
